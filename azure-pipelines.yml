# Python package
# Create and test a Python package on multiple Python versions.
# Add steps that analyze code, save the dist with the build record, publish to a PyPI-compatible index, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/python

trigger:
- master

pool:
  name: Default
steps:
- bash: |
    export PYTHONUNBUFFERED=1
    echo $USER
    set +x
    stf --docker-image-dont-pull test --sch-server-url 'https://trailer.streamsetscloud.com/' --sch-username 'prasanna@schops-customer-success' --sch-password "Passw0rd"  --pipeline_id "$(PIPELINE_ID)" --elasticsearch-url 'http://20.117.138.67:9200' --cluster-server kafka://172.28.0.4:9092 --kafka-version 2.7.0 --kafka-zookeeper 172.28.0.4:2181 -vv --upgrade-jobs --junit-xml=/root/tests/output/test-output.xml
    sudo chown -R azureuser:azureuser /home/azureuser/myagent
  displayName: 'Run Tests on Streamsets Pipeline'
